{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Subject_1 = require(\"./Subject\");\n\nvar queue_1 = require(\"./scheduler/queue\");\n\nvar Subscription_1 = require(\"./Subscription\");\n\nvar observeOn_1 = require(\"./operators/observeOn\");\n\nvar ObjectUnsubscribedError_1 = require(\"./util/ObjectUnsubscribedError\");\n\nvar SubjectSubscription_1 = require(\"./SubjectSubscription\");\n\nvar ReplaySubject = function (_super) {\n  __extends(ReplaySubject, _super);\n\n  function ReplaySubject(bufferSize, windowTime, scheduler) {\n    if (bufferSize === void 0) {\n      bufferSize = Number.POSITIVE_INFINITY;\n    }\n\n    if (windowTime === void 0) {\n      windowTime = Number.POSITIVE_INFINITY;\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.scheduler = scheduler;\n    _this._events = [];\n    _this._infiniteTimeWindow = false;\n    _this._bufferSize = bufferSize < 1 ? 1 : bufferSize;\n    _this._windowTime = windowTime < 1 ? 1 : windowTime;\n\n    if (windowTime === Number.POSITIVE_INFINITY) {\n      _this._infiniteTimeWindow = true;\n      _this.next = _this.nextInfiniteTimeWindow;\n    } else {\n      _this.next = _this.nextTimeWindow;\n    }\n\n    return _this;\n  }\n\n  ReplaySubject.prototype.nextInfiniteTimeWindow = function (value) {\n    if (!this.isStopped) {\n      var _events = this._events;\n\n      _events.push(value);\n\n      if (_events.length > this._bufferSize) {\n        _events.shift();\n      }\n    }\n\n    _super.prototype.next.call(this, value);\n  };\n\n  ReplaySubject.prototype.nextTimeWindow = function (value) {\n    if (!this.isStopped) {\n      this._events.push(new ReplayEvent(this._getNow(), value));\n\n      this._trimBufferThenGetEvents();\n    }\n\n    _super.prototype.next.call(this, value);\n  };\n\n  ReplaySubject.prototype._subscribe = function (subscriber) {\n    var _infiniteTimeWindow = this._infiniteTimeWindow;\n\n    var _events = _infiniteTimeWindow ? this._events : this._trimBufferThenGetEvents();\n\n    var scheduler = this.scheduler;\n    var len = _events.length;\n    var subscription;\n\n    if (this.closed) {\n      throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError();\n    } else if (this.isStopped || this.hasError) {\n      subscription = Subscription_1.Subscription.EMPTY;\n    } else {\n      this.observers.push(subscriber);\n      subscription = new SubjectSubscription_1.SubjectSubscription(this, subscriber);\n    }\n\n    if (scheduler) {\n      subscriber.add(subscriber = new observeOn_1.ObserveOnSubscriber(subscriber, scheduler));\n    }\n\n    if (_infiniteTimeWindow) {\n      for (var i = 0; i < len && !subscriber.closed; i++) {\n        subscriber.next(_events[i]);\n      }\n    } else {\n      for (var i = 0; i < len && !subscriber.closed; i++) {\n        subscriber.next(_events[i].value);\n      }\n    }\n\n    if (this.hasError) {\n      subscriber.error(this.thrownError);\n    } else if (this.isStopped) {\n      subscriber.complete();\n    }\n\n    return subscription;\n  };\n\n  ReplaySubject.prototype._getNow = function () {\n    return (this.scheduler || queue_1.queue).now();\n  };\n\n  ReplaySubject.prototype._trimBufferThenGetEvents = function () {\n    var now = this._getNow();\n\n    var _bufferSize = this._bufferSize;\n    var _windowTime = this._windowTime;\n    var _events = this._events;\n    var eventsCount = _events.length;\n    var spliceCount = 0;\n\n    while (spliceCount < eventsCount) {\n      if (now - _events[spliceCount].time < _windowTime) {\n        break;\n      }\n\n      spliceCount++;\n    }\n\n    if (eventsCount > _bufferSize) {\n      spliceCount = Math.max(spliceCount, eventsCount - _bufferSize);\n    }\n\n    if (spliceCount > 0) {\n      _events.splice(0, spliceCount);\n    }\n\n    return _events;\n  };\n\n  return ReplaySubject;\n}(Subject_1.Subject);\n\nexports.ReplaySubject = ReplaySubject;\n\nvar ReplayEvent = function () {\n  function ReplayEvent(time, value) {\n    this.time = time;\n    this.value = value;\n  }\n\n  return ReplayEvent;\n}(); //# sourceMappingURL=ReplaySubject.js.map","map":{"version":3,"sources":["/Users/volodymyrmaliarov/Projects/ngRxIntro/ngrx-store-intro/node_modules/rxjs/internal/ReplaySubject.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","defineProperty","exports","value","Subject_1","require","queue_1","Subscription_1","observeOn_1","ObjectUnsubscribedError_1","SubjectSubscription_1","ReplaySubject","_super","bufferSize","windowTime","scheduler","Number","POSITIVE_INFINITY","_this","call","_events","_infiniteTimeWindow","_bufferSize","_windowTime","next","nextInfiniteTimeWindow","nextTimeWindow","isStopped","push","length","shift","ReplayEvent","_getNow","_trimBufferThenGetEvents","_subscribe","subscriber","len","subscription","closed","ObjectUnsubscribedError","hasError","Subscription","EMPTY","observers","SubjectSubscription","add","ObserveOnSubscriber","i","error","thrownError","complete","queue","now","eventsCount","spliceCount","time","Math","max","splice","Subject"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subject_1 = require(\"./Subject\");\nvar queue_1 = require(\"./scheduler/queue\");\nvar Subscription_1 = require(\"./Subscription\");\nvar observeOn_1 = require(\"./operators/observeOn\");\nvar ObjectUnsubscribedError_1 = require(\"./util/ObjectUnsubscribedError\");\nvar SubjectSubscription_1 = require(\"./SubjectSubscription\");\nvar ReplaySubject = (function (_super) {\n    __extends(ReplaySubject, _super);\n    function ReplaySubject(bufferSize, windowTime, scheduler) {\n        if (bufferSize === void 0) { bufferSize = Number.POSITIVE_INFINITY; }\n        if (windowTime === void 0) { windowTime = Number.POSITIVE_INFINITY; }\n        var _this = _super.call(this) || this;\n        _this.scheduler = scheduler;\n        _this._events = [];\n        _this._infiniteTimeWindow = false;\n        _this._bufferSize = bufferSize < 1 ? 1 : bufferSize;\n        _this._windowTime = windowTime < 1 ? 1 : windowTime;\n        if (windowTime === Number.POSITIVE_INFINITY) {\n            _this._infiniteTimeWindow = true;\n            _this.next = _this.nextInfiniteTimeWindow;\n        }\n        else {\n            _this.next = _this.nextTimeWindow;\n        }\n        return _this;\n    }\n    ReplaySubject.prototype.nextInfiniteTimeWindow = function (value) {\n        if (!this.isStopped) {\n            var _events = this._events;\n            _events.push(value);\n            if (_events.length > this._bufferSize) {\n                _events.shift();\n            }\n        }\n        _super.prototype.next.call(this, value);\n    };\n    ReplaySubject.prototype.nextTimeWindow = function (value) {\n        if (!this.isStopped) {\n            this._events.push(new ReplayEvent(this._getNow(), value));\n            this._trimBufferThenGetEvents();\n        }\n        _super.prototype.next.call(this, value);\n    };\n    ReplaySubject.prototype._subscribe = function (subscriber) {\n        var _infiniteTimeWindow = this._infiniteTimeWindow;\n        var _events = _infiniteTimeWindow ? this._events : this._trimBufferThenGetEvents();\n        var scheduler = this.scheduler;\n        var len = _events.length;\n        var subscription;\n        if (this.closed) {\n            throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError();\n        }\n        else if (this.isStopped || this.hasError) {\n            subscription = Subscription_1.Subscription.EMPTY;\n        }\n        else {\n            this.observers.push(subscriber);\n            subscription = new SubjectSubscription_1.SubjectSubscription(this, subscriber);\n        }\n        if (scheduler) {\n            subscriber.add(subscriber = new observeOn_1.ObserveOnSubscriber(subscriber, scheduler));\n        }\n        if (_infiniteTimeWindow) {\n            for (var i = 0; i < len && !subscriber.closed; i++) {\n                subscriber.next(_events[i]);\n            }\n        }\n        else {\n            for (var i = 0; i < len && !subscriber.closed; i++) {\n                subscriber.next(_events[i].value);\n            }\n        }\n        if (this.hasError) {\n            subscriber.error(this.thrownError);\n        }\n        else if (this.isStopped) {\n            subscriber.complete();\n        }\n        return subscription;\n    };\n    ReplaySubject.prototype._getNow = function () {\n        return (this.scheduler || queue_1.queue).now();\n    };\n    ReplaySubject.prototype._trimBufferThenGetEvents = function () {\n        var now = this._getNow();\n        var _bufferSize = this._bufferSize;\n        var _windowTime = this._windowTime;\n        var _events = this._events;\n        var eventsCount = _events.length;\n        var spliceCount = 0;\n        while (spliceCount < eventsCount) {\n            if ((now - _events[spliceCount].time) < _windowTime) {\n                break;\n            }\n            spliceCount++;\n        }\n        if (eventsCount > _bufferSize) {\n            spliceCount = Math.max(spliceCount, eventsCount - _bufferSize);\n        }\n        if (spliceCount > 0) {\n            _events.splice(0, spliceCount);\n        }\n        return _events;\n    };\n    return ReplaySubject;\n}(Subject_1.Subject));\nexports.ReplaySubject = ReplaySubject;\nvar ReplayEvent = (function () {\n    function ReplayEvent(time, value) {\n        this.time = time;\n        this.value = value;\n    }\n    return ReplayEvent;\n}());\n//# sourceMappingURL=ReplaySubject.js.map"]},"metadata":{},"sourceType":"script"}